var MLR=MLR||{},$=jQuery||{};jQuery;MLR=MLR||{},$=jQuery||{};jQuery;MLR=MLR||{},$=jQuery||{};MLR.ajaxURL=mlr.ajax_url,MLR.limitUsage=function(e){e.preventDefault();var t=$(e.target),a=t.closest(".mlr-media-thumbnail").find("label"),i=$(".mlr-media-explorer img.selected").length;if("1"==$('input[type="checkbox"]',a).attr("data-selected"))$("img",a).toggleClass("selected"),$('input[type="checkbox"]',a).attr("data-selected",0),$(".dashicons",a).removeClass("dashicons-yes").addClass("dashicons-hidden");else{if(i>9)return window.alert("You cannot recover more than 10 images at a time."),!1;$("img",a).toggleClass("selected"),$('input[type="checkbox"]',a).attr("data-selected",1),$(".dashicons",a).removeClass("dashicons-hidden").addClass("dashicons-yes")}i=$(".mlr-media-explorer img.selected").length,$(".mlr-media-explore-nav .button-action span").empty().text(`You have selected ${i}/10 for recovery.`)},MLR.recoverMedia=function(e){e.preventDefault();var t=$(e.target),a=$(".mlr-media-explorer img"),i=[],r=$(".mlr-media-explore-nav .button-action span");if($.each(a,function(e,t){var a=$(t).prev();"1"==a.attr("data-selected")&&(i[e]=a.val().replace(/\\/g,"/"))}),0===i.length)return window.alert("You need to select at least 1 image for recovery."),!1;for(var l=0,o=0;l<i.length;l++)void 0!==i[l]&&o++;t.attr("disabled",!0).text("Recovering..."),r.empty().addClass("mlr-proccessing"),$.ajax({type:"post",url:MLR.ajaxURL,data:{action:"recover_media_library",images:JSON.stringify(i)},success:function(e,a,i){"1"==e?(t.attr("disabled",!1).text("Recover Media"),r.removeClass("mlr-proccessing").empty().html(`You have successfully recovered <strong>${o} media item(s)</strong>! Go to your <a href="/wp-admin/upload.php"><strong>Media Library</strong></a> to view the newly recovered files.`),$(".mlr-media-explorer").hide().load(window.location.href+" .mlr-media-explorer>*","").fadeIn()):console.log(e)}})},MLR.hideExistingMedia=function(e){void 0!==e&&(localStorage.getItem("mlr-existing-media")?localStorage.removeItem("mlr-existing-media"):localStorage.setItem("mlr-existing-media",1)),localStorage.getItem("mlr-existing-media")&&$('input[name="mlr-hide-existing-media"]').attr("checked",!0),$.each($(".mlr-media-thumbnail"),function(e,t){$(".dashicons",$(t)).hasClass("dashicons-visibility")&&$(t).toggle()})},function(e,t){setTimeout(function(){e(".mlr-media-explorer").css("display","flex")},500),localStorage.getItem("mlr-existing-media")&&MLR.hideExistingMedia(),e(document).on("click",".mlr-media-thumbnail label",MLR.limitUsage),e(document).on("click",'button[name="mlr-recover-media-button"]',MLR.recoverMedia),e(document).on("click",'input[name="mlr-hide-existing-media"]',MLR.hideExistingMedia)}(jQuery);