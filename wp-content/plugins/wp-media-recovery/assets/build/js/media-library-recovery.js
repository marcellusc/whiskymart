var MLR = MLR || {};var $ = jQuery || {};(function ($, _undefined) {})(jQuery);var MLR = MLR || {};var $ = jQuery || {};(function ($, _undefined) {})(jQuery);var MLR = MLR || {};var $ = jQuery || {};MLR.ajaxURL = mlr.ajax_url;MLR.limitUsage = function(event){event.preventDefault();var $elem            = $(event.target);var $label           = $elem.closest('.mlr-media-thumbnail').find('label');var $selected_images = $('.mlr-media-explorer img.selected').length;if ($('input[type="checkbox"]', $label).attr('data-selected') == '1') {$('img', $label).toggleClass('selected');$('input[type="checkbox"]', $label).attr('data-selected', 0);$('.dashicons', $label).removeClass('dashicons-yes').addClass('dashicons-hidden');} else {if ($selected_images > 9) {window.alert('You cannot recover more than 10 images at a time.');return false;} else {$('img', $label).toggleClass('selected');$('input[type="checkbox"]', $label).attr('data-selected', 1);$('.dashicons', $label).removeClass('dashicons-hidden').addClass('dashicons-yes');}}$selected_images = $('.mlr-media-explorer img.selected').length;$('.mlr-media-explore-nav .button-action span').empty().text(`You have selected ${$selected_images}/10 for recovery.`);};MLR.recoverMedia = function(event){event.preventDefault();var $elem            = $(event.target);var $images          = $(".mlr-media-explorer img");var $selected_images = [];var $message_cont    = $('.mlr-media-explore-nav .button-action span');$.each($images, function (key, image) {var $input = $(image).prev();if ($input.attr('data-selected') == '1') {$selected_images[key] = $input.val().replace(/\\/g, "/");}});if ($selected_images.length === 0) {window.alert('You need to select at least 1 image for recovery.');return false;}for (var i = 0, length = 0; i < $selected_images.length; i++) {$selected_images[i] !== undefined && length++;}$elem.attr('disabled', true).text('Recovering...');$message_cont.empty().addClass('mlr-proccessing');$.ajax({type: 'post',url: MLR.ajaxURL,data: {action: 'recover_media_library',images: JSON.stringify($selected_images),},success: function (response, status, xhr) {if (response == '1') {$elem.attr('disabled', false).text('Recover Media');$message_cont.removeClass('mlr-proccessing').empty().html(`You have successfully recovered <strong>${length} media item(s)</strong>! Go to your <a href="/wp-admin/upload.php"><strong>Media Library</strong></a> to view the newly recovered files.`);$(".mlr-media-explorer").hide().load(window.location.href + ' .mlr-media-explorer>*', '').fadeIn();} else {console.log(response);}}});};MLR.hideExistingMedia = function(event){if (event !== undefined) {if (!localStorage.getItem('mlr-existing-media')) {localStorage.setItem('mlr-existing-media', 1);} else {localStorage.removeItem('mlr-existing-media');}}if (localStorage.getItem('mlr-existing-media')) {$('input[name="mlr-hide-existing-media"]').attr('checked', true);}$.each($(".mlr-media-thumbnail"), function (idx, thumbnail) {if ($('.dashicons', $(thumbnail)).hasClass("dashicons-visibility")) {$(thumbnail).toggle();}});};(function ($, _undefined) {setTimeout(function() {$('.mlr-media-explorer').css('display', 'flex');}, 500);if (localStorage.getItem('mlr-existing-media')) {MLR.hideExistingMedia();}$(document).on('click', '.mlr-media-thumbnail label', MLR.limitUsage);$(document).on('click', 'button[name="mlr-recover-media-button"]', MLR.recoverMedia);$(document).on('click', 'input[name="mlr-hide-existing-media"]', MLR.hideExistingMedia)})(jQuery);